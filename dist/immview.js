!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.immview=e():t.immview=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";var n=r(1),i=r(2),s=r(3);e.Observable=s.Observable;var o=r(6);e.Data=o.Data;var u=r(10);e.Merge=u.Merge;var c=r(9);e.Domain=c.Domain;var a=r(8);e.action=a.action;var p=function(t){n.Dispatcher.push(t,i.DispatcherPriorities.EXTERNAL)};e.dispatch=p},function(t,e,r){"use strict";var n=r(7),i=r(2),s=new n.Dispatcher;e.Dispatcher=s;var o=function(t,e){void 0===e&&(e=i.DispatcherPriorities.EXTERNAL),s.push(t,e),s.run()};e.dispatch=o;var u=function(t,e){return void 0===e&&(e=i.DispatcherPriorities.EXTERNAL),new Promise(function(r,n){o(function(){try{r(t())}catch(t){console.error(t.stack||t.message||t),n(t)}},e)})};e.dispatchPromise=u},function(t,e){"use strict";var r;!function(t){t[t.OBSERVABLE=1]="OBSERVABLE",t[t.DOMAIN=2]="DOMAIN",t[t.BUFFER=3]="BUFFER",t[t.EXTERNAL=4]="EXTERNAL",t[t.TEST=10]="TEST"}(r=e.DispatcherPriorities||(e.DispatcherPriorities={}))},function(t,e,r){"use strict";var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},i=r(4),s=r(2),o=r(1),u="undefined"!=typeof Symbol?Symbol("ObservableSymbol"):"ObservableSymbol",c=function(t){function e(){return t.apply(this,arguments)||this}return n(e,t),e.of=function(){for(var t=[],r=0;arguments.length>r;r++)t[r]=arguments[r];return e.from(t)},e.from=function(t){if(t[u])return new e(function(e){t[u]().subscribe(e.next,e.error,e.complete)});if(t[Symbol.iterator])return new e(function(e){for(var r=e.next,n=e.error,i=t[Symbol.iterator](),s=i.next();s.done===!1;s=i.next())s.value instanceof Error?n(s.value):r(s.value)});throw Error("Observable.from incorrect input")},e.prototype.map=function(t){var r=this;return new e(function(e){var n=r.subscribe(function(r){if(!e.closed)try{e.next(t(r))}catch(t){e.error(t)}},e.error,e.complete);return function(){return n.unsubscribe()}})},e.prototype.flatMap=function(t){throw Error("not implemented")},e.prototype.reduce=function(t){var r=this;return new e(function(e){var n=null,i=r.subscribe(function(r){if(!e.closed){var i;try{i=n?t(r,n):r,n=i}catch(t){e.error(t)}e.next(i)}},e.error,e.complete);return function(){return i.unsubscribe()}})},e.prototype.filter=function(t){var r=this;return new e(function(e){var n=r.subscribe(function(r){if(!e.closed)try{t(r)&&e.next(r)}catch(t){e.error(t)}},e.error,e.complete);return function(){return n.unsubscribe()}})},e.prototype.scan=function(t,e,r){throw void 0===e&&(e=2),void 0===r&&(r=null),Error("not implemented")},e.prototype.buffer=function(t){var r=this;void 0===t&&(t=0);var n=[];return new e(function(e){var i=r.subscribe(function(r){n=t>0?[r].concat(n).splice(0,t):[r].concat(n),o.Dispatcher.push(function(){1>n.length||e.closed||e.next(n.splice(0,n.length).reverse())},s.DispatcherPriorities.BUFFER).run()},e.error,function(){n.length>0&&e.next(n.splice(0,n.length).reverse()),e.complete()});return function(){return i.unsubscribe()}})},e}(i.BaseObservable);e.Observable=c,c.prototype[u]=function(){return this}},function(t,e,r){"use strict";var n=r(1),i=r(2),s=r(5),o=function(){function t(t,e,r,n){this.next=t,this.error=e,this.complete=r,this._closed=n}return Object.defineProperty(t.prototype,"closed",{get:function(){return this._closed()},enumerable:!0,configurable:!0}),t}();e.SubscriptionObserver=o;var u;!function(t){t[t.Next=0]="Next",t[t.Error=1]="Error",t[t.Complete=2]="Complete"}(u=e.MessageTypes||(e.MessageTypes={}));var c=function(){},a=function(){function t(e){var r=this;this.closed=!1,this.nextSubscriptions=[],this.errorSubscriptions=[],this.completionSubscriptions=[],this.priority=t.lastObservablePriority++,this.cancelSubscriber=e&&e(new o(function(t){r.closed||r.pushMessage([u.Next,"function"==typeof t?t:function(){return t},c])},function(t){r.closed||r.pushMessage([u.Error,t,c])},function(){r.closed||r.pushMessage([u.Complete,,c])},function(){return r.closed}))||c}return t.prototype.last=function(){var e=this;if(this.lastValue)return this.lastValue;if(this.nextSubscriptions.length>0)return this.lastValue;var r=t.awaitingMessages.filter(function(t){var r=t[0];return r===e});if(0!==r.length){var n=r[0],i=n[1];return i[0]===u.Next?(t.awaitingMessages=t.awaitingMessages.filter(function(t){return t!==n}),this.lastValue=i[1](this.lastValue)):void 0}},t.prototype.subscribe=function(e,r,n){var i=this;if(this.closed)return new s.BaseObservableSubscription(null);var o=function(){u.unsubscribe(),i.completionSubscriptions=i.completionSubscriptions.filter(function(t){return t!==o})};this.completionSubscriptions.push(o),e&&this.nextSubscriptions.push(e),r&&this.errorSubscriptions.push(r),n&&this.completionSubscriptions.push(n);var u=new s.BaseObservableSubscription(function(){e&&(i.nextSubscriptions=i.nextSubscriptions.filter(function(t){return t!==e})),r&&(i.errorSubscriptions=i.errorSubscriptions.filter(function(t){return t!==r})),n&&(i.completionSubscriptions=i.completionSubscriptions.filter(function(t){return t!==n}))});return t.dispatchDigestMessages(),u},t.prototype.cancel=function(){this.pushMessage([u.Complete,,c])},t.prototype.pushMessage=function(e){t.awaitingMessages.push([this,e]),t.dispatchDigestMessages()},t.dispatchDigestMessages=function(){n.dispatch(t.digestAwaitingMessages,i.DispatcherPriorities.OBSERVABLE)},t.digestAwaitingMessages=function(){var e=t.popMessage(),r=e[0],n=e[1];r&&(t.digestNodeMessage(r,n),t.dispatchDigestMessages())},t.popMessage=function(){if(0===t.awaitingMessages.length)return[null,null];for(var e=0;t.awaitingMessages.length>e;e++){var r=t.awaitingMessages[e],n=r[0],i=void 0===n?null:n,s=r[1];if((s[0]!==u.Next||i.nextSubscriptions.length)&&(s[0]!==u.Error||i.errorSubscriptions.length)&&(s[0]!==u.Complete||i.completionSubscriptions.length))return t.awaitingMessages.splice(e,1),[i,s]}return[null,null]},t.digestNodeMessage=function(t,e){if(!t.closed){var r=e[0],n=e[2];if(r===u.Next){var i=e,s=i[1],o=s(t.lastValue);t.lastValue=o,t.nextSubscriptions.forEach(function(t){return t(o)})}else if(r===u.Error){var a=e,p=a[1];t.errorSubscriptions.forEach(function(t){return t(p)})}else r===u.Complete&&(t.cancelSubscriber(),t.cancelSubscriber=c,t.closed=!0,t.completionSubscriptions.forEach(function(t){return t()}));n()}},t}();a.awaitingMessages=[],a.lastObservablePriority=0,e.BaseObservable=a},function(t,e){"use strict";var r=function(){function t(t){this._unsubscribe=t}return Object.defineProperty(t.prototype,"closed",{get:function(){return!this._unsubscribe},enumerable:!0,configurable:!0}),t.prototype.unsubscribe=function(){var t=this._unsubscribe;this._unsubscribe=null,t&&t()},t}();e.BaseObservableSubscription=r},function(t,e,r){"use strict";var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},i=r(4),s=r(3),o=function(t){function e(e){var r=t.call(this,function(t){t.next(e)})||this;return r.lastValue=e,r}return n(e,t),e.prototype.write=function(t){var e=this;return new Promise(function(r){e.pushMessage([i.MessageTypes.Next,"function"==typeof t?t:function(){return t},r])})},e}(s.Observable);e.Data=o},function(t,e){"use strict";var r=function(){function t(){this.nextTickScheduler=null,this._isRunning=!1,this.tasks=[]}return Object.defineProperty(t.prototype,"isRunning",{get:function(){return!!this._isRunning},enumerable:!0,configurable:!0}),t.prototype.push=function(t,e){return void 0===e&&(e=0),this.tasks.push({priority:e,job:t}),this},t.prototype.run=function(){var t=this;if(!this._isRunning){this._isRunning=!0;var e=this.findNextJob();return e?void(this.nextTickScheduler=this.nextTickScheduler||Promise.resolve()).then(function(){t.next(function(){try{e.job()}catch(t){console.error(t.stack||t.message||t)}},function(){t._isRunning=!1,t.run()})}):(this.nextTickScheduler=null,void(this._isRunning=!1))}},t.prototype.findNextJob=function(){for(var t=null,e=0;this.tasks.length>e;e++)(null===t||this.tasks[t].priority>this.tasks[e].priority)&&(t=e);return null===t?null:this.tasks.splice(t,1)[0]},t.prototype.next=function(t,e){t(),e()},t}();e.Dispatcher=r},function(t,e,r){"use strict";function n(t,e,r){var n=r.value;r.value=function(){for(var t=this,e=[],r=0;arguments.length>r;r++)e[r]=arguments[r];return s.dispatchPromise(function(){n.apply(t,e)},i.DispatcherPriorities.DOMAIN)}}var i=r(2),s=r(1);e.action=n},function(t,e,r){"use strict";var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},i=r(3),s=r(1),o=function(t){function e(e){return t.call(this,function(t){e.subscribe(t.next,t.error,t.complete)})||this}return n(e,t),e.create=function(t,r,n){var i=new e(t);if(r){var o=function(t){return Object.prototype.hasOwnProperty.call(r,t)?void(i[t]=function(){for(var e=[],n=0;arguments.length>n;n++)e[n]=arguments[n];return s.dispatchPromise((o=r[t]).bind.apply(o,[i].concat(e)));var o}):"continue"};for(var u in r)o(u)}if(n)for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(i[c]=n[c]);return i},e}(i.Observable);e.Domain=o},function(t,e,r){"use strict";var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},i=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;n>r;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},s=r(3),o=function(t){function e(e){return t.call(this,function(t){var r=[],n=[],s=[],o={},u=[],c=function(c){return Object.prototype.hasOwnProperty.call(e,c)?(r.push(c),void u.push(e[c].subscribe(function(e){if(s&&s.push([c,e]),n.indexOf(c)<0&&n.push(c),r.length===n.length){if(s){for(var u={},a=[],p=[],f=0;s.length>f;f++)if(a.indexOf(s[f][0])<0){var l=s[f],h=l[0],b=l[1];u[h]=b,a.push(h)}else p.push(s[f]);return t.next(o=u),p.forEach(function(e){var r=e[0],n=e[1];t.next(o=i({},o,(s={},s[r]=n,s)));var s}),void(s=null)}t.next(o=i({},o,(v={},v[c]=e,v)));var v}}))):"continue"};for(var a in e)c(a);return function(){u.forEach(function(t){return t()})}})||this}return n(e,t),e}(s.Observable);e.Merge=o}])});
//# sourceMappingURL=immview.js.map