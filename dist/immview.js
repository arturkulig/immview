!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("immutable")):"function"==typeof define&&define.amd?define(["immutable"],e):"object"==typeof exports?exports.immview=e(require("immutable")):t.immview=e(t.immutable)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.dispatch=e.Dispatcher=e.Throttle=e.Debounce=e.Domain=e.View=e.Data=void 0;var o=n(1),i=r(o),u=n(3),s=r(u),c=n(8),a=r(c),f=n(9),l=r(f),d=n(10),h=r(d),p=n(2),m=r(p),v=m.default.dispatch;e.Data=s.default,e.View=a.default,e.Domain=i.default,e.Debounce=l.default,e.Throttle=h.default,e.Dispatcher=m.default,e.dispatch=v},function(t,e,n){"use strict";function r(t,e){if(!t.subscribe)throw Error(u+" stream source required");this.stream=t,this._claimActions(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;var o=n(2),i=function(){return null},u="Immview::Domain: ";r.prototype={_claimActions:function(t){var e=this;this._actionNames=t?Object.keys(t):[],this._actionNames.forEach(function(n){if(e[n])throw Error(""+u+n+" is reserved for Domain interface");if("function"!=typeof t[n])throw Error(""+u+n+" action is not a function");e[n]=function(){for(var r=arguments.length,i=Array(r),u=0;r>u;u++)i[u]=arguments[u];(0,o.dispatchDomainAction)(t[n],e,i,1)}})},read:function(){return this.stream.read()},map:function(t){return this.stream.map(t)},debounce:function(t){return this.stream.debounce(t)},throttle:function(t){return this.stream.throttle(t)},subscribe:function(t){return this.stream.subscribe(t)},appendReactor:function(t){return this.stream.appendReactor(t)},destroy:function(){var t=this;this.stream.destroy(),this.stream=null,(0,o.rejectContext)(this),this._actionNames.forEach(function(e){t[e]=i}),this._actionNames=null}}},function(t,e){"use strict";function n(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function r(){for(var t=-1,e=null,n=0;m.length>n;n++){var r=m[n].priority;r>t&&(e=m[n],t=r)}return e}function o(){var t=r();return m.splice(m.indexOf(t),1),t}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:g;m.push({priority:r,action:t,context:e,args:n})}function u(){p||m.length>0&&(p=!0,O.tick(function(){try{_()}catch(t){s(t)}p=!1,u()}))}function s(t){O.logger.error(v+"Error occured while running a function"),"object"===(void 0===t?"undefined":n(t))?t.stack?O.logger.error(t.stack):O.logger.error(t.name,t.message):O.logger.error(t)}function c(t,e,n,r){i(t,e,n,r),u()}function a(t,e,n){c(t,e,n,b)}function f(t,e,n){c(t,e,n,y)}function l(t,e,n){c(t,e,n,D)}function d(t,e,n){c(t,e,n,g)}function h(t){m=m.filter(function(e){return e.context!==t})}Object.defineProperty(e,"__esModule",{value:!0}),e.dispatch=c,e.dispatchDomainAction=a,e.dispatchDataWrite=f,e.dispatchDataConsume=l,e.dispatchExternal=d,e.rejectContext=h;var p=!1,m=[],v="Immview::Dispatcher: ",g=0,b=1,y=2,D=3,_=function(){var t=o();if(t){var e=t.context,n=t.action,r=t.args;n&&n.apply(e,r)}},O=e.Dispatcher={dispatch:d,tick:function(t){t()},rejectContext:h,logger:console};e.default=O},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t){a.default.call(this),this.linkTo(null),this.digest((0,u.fromJS)(t))}var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var u=n(4),s=n(2),c=n(5),a=r(c);o.prototype=i({},a.default.prototype,{write:function(t){var e=this;(0,s.dispatchDataWrite)(function(){"function"==typeof t?e.consume(e.read(),t):e.consume(t)})}})},function(e,n){e.exports=t},function(t,e,n){"use strict";function r(t){return void 0!==t&&null!==t}function o(t,e){return r(e)&&(!r(t)||!(0,a.is)(e,t))}function i(t,e){var n=(0,f.createSchedule)(t);return(0,f.copyQueueOntoSchedule)(e,n)}function u(){(0,f.scheduleLength)(h)>0&&(h=(0,f.runScheduledPriorityJob)(h),(0,l.dispatchDataWrite)(u))}function s(t){return t}function c(){this.reactors=(0,a.Set)()}Object.defineProperty(e,"__esModule",{value:!0}),e.default=c;var a=n(4),f=n(6),l=n(2),d=[],h=[];c.prototype={read:function(){return this.structure},linkTo:function(t){d.push([t&&(t.stream?t.stream:t),this]),h=i(d,h)},unlink:function(){var t=this;d=d.filter(function(e){return e[0]!==t&&e[1]!==t}),h=i(d,h)},consume:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s;(0,l.dispatchDataConsume)(function(){h=(0,f.scheduleJob)(e,function(){return e.digest(n(t))},h),(0,l.dispatchDataWrite)(u)})},digest:function(t){o(this.structure,t)&&(this.structure=t,this.flush())},appendReactor:function(t){var e=this;return this.reactors=this.reactors.add(t),function(){e.reactors=e.reactors.delete(t)}},subscribe:function(t){return t(this.read()),this.appendReactor(t)},flush:function(){var t=this;this.reactors.forEach(function(e){return e(t.read())})},destroy:function(){this.unlink(),this.structure=null,this.reactors=(0,a.Set)()},map:function(t){var e=n(8).default;return new e(this,t)},debounce:function(t){var e=n(9).default;return new e(this,t)},throttle:function(t){var e=n(10).default;return new e(this,t)}}},function(t,e,n){"use strict";function r(t){return f(t).reduce(function(t,e){return t.unshift([e,null]),t},[])}function o(t,e,n){for(var r=[],o=0;n.length>o;o++){var i=n[o],u=i[0];r.push(u===t?[u,e]:i)}return r}function i(t){for(var e=0,n=0;t.length>n;n++)e+=0|!!t[n][1];return e}function u(t,e){for(var n=0;t.length>n;n++)if(t[n][0]===e)return t[n][1];return null}function s(t,e){for(var n=[].concat(e),r=0;t.length>r;r++){var o=t[r],i=o[0],u=o[1];if(u)for(var s=0;n.length>s;s++){var c=n[s],a=c[0];a===i&&(n[s]=o)}}return n}function c(t){for(var e=null,n=[].concat(t),r=0;t.length>r;r++){var o=t[r],i=o[0],u=o[1];u&&!e&&(e=u,n[r]=[i,null])}return e&&e(),n}Object.defineProperty(e,"__esModule",{value:!0}),e.sortStreamGraph=void 0,e.createSchedule=r,e.scheduleJob=o,e.scheduleLength=i,e.findJob=u,e.copyQueueOntoSchedule=s,e.runScheduledPriorityJob=c;var a=n(7),f=e.sortStreamGraph=a.getOrder},function(t,e){"use strict";function n(t){return t.reduce(function(t,e){return t.indexOf(e[0])<0&&t.push(e[0]),t.indexOf(e[1])<0&&t.push(e[1]),t},[])}function r(t){var e=[],r=[];return n(t).forEach(function(n){if(!e||e.indexOf(n)<0){var i=o(t,n,r,e);e=i.visited,r=i.stack}}),r}function o(t,e,n,r){var u=r.concat([e]),s=n;return i(t,e).forEach(function(e){if(!u||u.indexOf(e)<0){var n=o(t,e,s,u);u=n.visited,s=n.stack}}),{visited:u,stack:s.concat([e])}}function i(t,e){return t.filter(function(t){return t[0]===e}).map(function(t){return t[1]})}Object.defineProperty(e,"__esModule",{value:!0}),e.getGraphNodes=n,e.getOrder=r,e.visit=o,e.getNodeChildren=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f;a.default.call(this),t&&"object"===(void 0===t?"undefined":o(t))&&(t.subscribe?this.connectToSource(t,e):this.connectToMultipleSources(t,e))}var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var s=n(4),c=n(5),a=r(c),f=function(t){return t};i.prototype=u({},a.default.prototype,{connectToSource:function(t,e){var n=this;this.linkTo(t),this.digest(e(t.read())),this.unsubs=[t.appendReactor(function(t){return n.digest(e(t))})]},connectToMultipleSources:function(t,e){var n=this,r=(0,s.Map)(),o=Object.keys(t);o.forEach(function(e){var o=t[e];n.linkTo(o);var i=o.read();r=r.set(e,i)}),this.unsubs=o.map(function(o){return t[o].appendReactor(function(t){r=r.set(o,t),n.consume(r,e)})}),this.digest(e(r))},destroy:function(){a.default.prototype.destroy.call(this),this.unsubs&&this.unsubs.forEach(function(t){return t()}),this.unsubs=null}})},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(s.default.call(this),!t||!t.subscribe)throw Error(c+"incorrect source");this.linkTo(t),this.timeoutID=null,this.digest(t.read()),this.subscription=t.appendReactor(function(t){e.timeoutID&&clearTimeout(e.timeoutID),e.timeoutID=setTimeout(function(){e.timeoutID=null,e.consume(t)},n)})}var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var u=n(5),s=r(u),c="Immview::Debounce: ";o.prototype=i({},s.default.prototype,{destroy:function(){this.timeoutID&&(clearTimeout(this.timeoutID),this.timeoutID=null),this.subscription&&this.subscription(),s.default.prototype.destroy.call(this)}})},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(s.default.call(this),!t||!t.subscribe)throw Error(c+"incorrect source");this.linkTo(t),this.timeoutID=null,this.timeoutedData=null,this.digest(t.read()),this.subscription=t.appendReactor(function(t){e.timeoutedData=t,e.timeoutID||(e.timeoutID=setTimeout(function(){e.timeoutID=null,e.consume(e.timeoutedData)},n))})}var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var u=n(5),s=r(u),c="Immview::Throttle: ";o.prototype=i({},s.default.prototype,{destroy:function(){this.timeoutID&&(clearTimeout(this.timeoutID),this.timeoutID=null),this.subscription&&this.subscription(),s.default.prototype.destroy.call(this)}})}])});
//# sourceMappingURL=immview.js.map